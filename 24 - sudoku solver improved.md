Use yor existing solution with threads. Do not forget to test this!